name: Promote release

on:
    workflow_dispatch:
        inputs:
            version:
                description: 'Define git sha'

jobs:
    deploy:
        name: deploy
        runs-on: ubuntu-latest

        permissions:
            contents: write
            packages: write

        steps:
            -   name: Get list of releases
                run: |
                    releases=$(curl -H "Authorization: token $GITHUB_TOKEN" -H "Accept: application/vnd.github+json" https://api.github.com/repos/giedriusvickus/actions-test-1/releases)

            -   name: Loop through releases
                run: |
                    echo $releases

            -   name: Loop through releases
                run: |
                    for release_id in $(echo $releases | jq -r '.[].id'); do
                        release_name=$(echo $releases | jq -r ".[] | select(.id == $release_id).name")
                    if [[ $release_name == *"(ACTIVE)"* ]]; then
                        export RELEASE_ID=$release_id
                        break
                    fi
                    done
